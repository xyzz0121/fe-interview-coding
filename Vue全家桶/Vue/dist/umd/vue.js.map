{"version":3,"file":"vue.js","sources":["../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["/**\n * 用 defineProperty 递归把data所有属性都变成响应式\n */\nclass Observer{\n    constructor(data){\n        //一步一步把defineProperty全都重新定义一下 使原来的对象每个属性发生变化的时候 都能get到，也就是将一个普通对象变成一个响应式对象\n        this.walk(data);\n    }\n    walk(data){\n        const keys = Object.keys(data);\n        keys.forEach(key => {\n            defineReactive(data, key, data[key]); \n        })\n    }\n}\n//Vue.util.defineReactive 把对象的某个属性变成响应式\nfunction defineReactive(data, key, value) {\n    observe(value);\n    Object.defineProperty(data, key, {\n        get(){\n            console.log(\"获取\", data, key, value);\n            return value\n        },\n        set(newValue){\n            console.log(\"设置\", data, key, value);\n            if(value === newValue) return ;\n            observe(newValue);\n            value = newValue;\n        }\n    })\n}\n\n\n\nexport function observe(data) {\n    if(typeof data !== \"object\" || data === null){\n        return ;\n    }\n    return new Observer(data);\n}","import { observe } from \"./observer/index\";\n\nexport function initState(vm) {\n    const opts = vm.$options;\n    //按照优先级先后初始化，如果后面的和前面的重名了，怎么怎么样\n    if (opts.props) {\n        initProps(vm);\n    }\n    if (opts.methods) {\n        initMethods(vm);\n    }\n    if (opts.data) {\n        initData(vm);\n    }\n    if (opts.watch) {\n        initWatch(vm);\n    }\n    if (opts.computed) {\n        initComputed(vm);\n    }\n}\n\nfunction initProps() {}\n\nfunction initMethods() {}\n\nfunction initData(vm) {\n    let data = vm.$options.data;\n    vm._data = data = typeof data ? data.call(vm) : data;\n    //有对象了 就要劫持 \n    //对象的劫持方案：object.defineProperty();\n    //对象里嵌套数组的劫持方案: 单独处理\n    observe(data);\n}\n\nfunction initWatch() {}\n\nfunction initComputed() {}","import { initState } from \"./state\";\n\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n        const vm = this;\n        vm.$options = options;\n        //所有初始化操作，都在initState里\n        initState(vm);\n        // initEvents();\n    }\n}","import { initMixin } from \"./init\";\n\n/**\n * Vue 类的声明\n * @param {object} options 用户 new Vue() 时传的配置对象\n */\nfunction Vue(options) {\n    this._init(options);\n}\n\n//Vue把原型方法拆成一个一个又一个的插件，利于拆分，结构拆分，所有原型拓展都在这里\n\n//插件1：初始化操作都在这里\ninitMixin(Vue);\n\nexport default Vue;"],"names":["Observer","data","walk","keys","Object","forEach","key","defineReactive","value","observe","defineProperty","get","console","log","set","newValue","initState","vm","opts","$options","props","methods","initData","watch","computed","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA;EACA;MACMA;EACF,oBAAYC,IAAZ,EAAiB;EAAA;;EACb;EACA,SAAKC,IAAL,CAAUD,IAAV;EACH;;;;aACD,cAAKA,IAAL,EAAU;EACN,UAAME,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYF,IAAZ,CAAb;EACAE,MAAAA,IAAI,CAACE,OAAL,CAAa,UAAAC,GAAG,EAAI;EAChBC,QAAAA,cAAc,CAACN,IAAD,EAAOK,GAAP,EAAYL,IAAI,CAACK,GAAD,CAAhB,CAAd;EACH,OAFD;EAGH;;;;;;;EAGL,SAASC,cAAT,CAAwBN,IAAxB,EAA8BK,GAA9B,EAAmCE,KAAnC,EAA0C;EACtCC,EAAAA,OAAO,CAACD,KAAD,CAAP;EACAJ,EAAAA,MAAM,CAACM,cAAP,CAAsBT,IAAtB,EAA4BK,GAA5B,EAAiC;EAC7BK,IAAAA,GAD6B,iBACxB;EACDC,MAAAA,OAAO,CAACC,GAAR,CAAY,IAAZ,EAAkBZ,IAAlB,EAAwBK,GAAxB,EAA6BE,KAA7B;EACA,aAAOA,KAAP;EACH,KAJ4B;EAK7BM,IAAAA,GAL6B,eAKzBC,QALyB,EAKhB;EACTH,MAAAA,OAAO,CAACC,GAAR,CAAY,IAAZ,EAAkBZ,IAAlB,EAAwBK,GAAxB,EAA6BE,KAA7B;EACA,UAAGA,KAAK,KAAKO,QAAb,EAAuB;EACvBN,MAAAA,OAAO,CAACM,QAAD,CAAP;EACAP,MAAAA,KAAK,GAAGO,QAAR;EACH;EAV4B,GAAjC;EAYH;;EAIM,SAASN,OAAT,CAAiBR,IAAjB,EAAuB;EAC1B,MAAG,QAAOA,IAAP,MAAgB,QAAhB,IAA4BA,IAAI,KAAK,IAAxC,EAA6C;EACzC;EACH;;EACD,SAAO,IAAID,QAAJ,CAAaC,IAAb,CAAP;EACH;;ECrCM,SAASe,SAAT,CAAmBC,EAAnB,EAAuB;EAC1B,MAAMC,IAAI,GAAGD,EAAE,CAACE,QAAhB,CAD0B;;EAG1B,MAAID,IAAI,CAACE,KAAT,EAAgB;;EAGhB,MAAIF,IAAI,CAACG,OAAT,EAAkB;;EAGlB,MAAIH,IAAI,CAACjB,IAAT,EAAe;EACXqB,IAAAA,QAAQ,CAACL,EAAD,CAAR;EACH;;EACD,MAAIC,IAAI,CAACK,KAAT,EAAgB;;EAGhB,MAAIL,IAAI,CAACM,QAAT,EAAmB;EAGtB;;EAMD,SAASF,QAAT,CAAkBL,EAAlB,EAAsB;EAClB,MAAIhB,IAAI,GAAGgB,EAAE,CAACE,QAAH,CAAYlB,IAAvB;EACAgB,EAAAA,EAAE,CAACQ,KAAH,GAAWxB,IAAI,GAAG,QAAOA,IAAP,IAAcA,IAAI,CAACyB,IAAL,CAAUT,EAAV,CAAd,GAA8BhB,IAAhD,CAFkB;EAIlB;EACA;;EACAQ,EAAAA,OAAO,CAACR,IAAD,CAAP;EACH;;EC/BM,SAAS0B,SAAT,CAAmBC,GAAnB,EAAwB;EAC3BA,EAAAA,GAAG,CAACC,SAAJ,CAAcC,KAAd,GAAsB,UAAUC,OAAV,EAAmB;EACrC,QAAMd,EAAE,GAAG,IAAX;EACAA,IAAAA,EAAE,CAACE,QAAH,GAAcY,OAAd,CAFqC;;EAIrCf,IAAAA,SAAS,CAACC,EAAD,CAAT,CAJqC;EAMxC,GAND;EAOH;;ECRD;EACA;EACA;EACA;;EACA,SAASW,GAAT,CAAaG,OAAb,EAAsB;EAClB,OAAKD,KAAL,CAAWC,OAAX;EACH;EAID;;;EACAJ,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}